<!DOCTYPE html>
<html>
<head>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
<script src="dist/asciimath2tex.umd.js"></script>
<script src='dist/md_asciimath_like.js'></script>
<link rel="stylesheet" href="dist/style.css">

	
<title>SQL</title>
</head>
<body>


[NAVBAR Главная :: index.html]

# Об SQL, корохотенько

![https://kulturologia.ru/files/u23581/235811589.jpg](intro)


SQL структурированный язык запросов к базам данных.


Самих запросов бывает 4 типа:

- создающие (+ уничтожающие)

- модифицирующие

- меняющие уровень доступа

- и работа с версиями (коммиты и роллбэки)



В базу данных можно класть таблицы, в таблицах есть столбцы,
в столбцах есть данные заданного типа,
которые подходят по заданным ограничениям.


Перед тем как данные в базу собирать, её проектируют

# ER диаграма

Вначале рисуется диаграма отношений сущностей



![https://d3n817fwly711g.cloudfront.net/uploads/2012/03/ER-Diagram-Example.jpeg](ER диаграма)

Вот сущность *Писатель* имеет связь *Создать* с сущностью *Новелла*.





![https://d3n817fwly711g.cloudfront.net/blog/wp-content/uploads/2012/03/Attributes-ER-Diagrams.jpeg](ещё ER диаграма)

Вот сущность *Покупатель* имеет аттрибуты *Имя*, *Адрес*, *Id*-шник.


Атрибут, особенный для отдельной реальзации сущности, называется **ключом**
и на таких диаграмах он должен подчёркиваться,
а тут **сурогатный** (в реальной жизни не существующий) **ключ** -- *Id* нифига не подчёркнут.

Ну не подчёркнут и не подчёркнут )




Ещё **ключ** бывает **составной**, то есть составленный из нескольких атрибутов, но об этом потом.


# Перегон диаграм в таблицы

Для каждой сущности должна создаваться таблица.

Там каждая строка -- отдельная реализация сущности, а столбец -- это атрибут.


Со связями замороченнее.

- Если связь 1:1, то можно(нужно) хранить сущности в одной таблице.

- Если связь 1:N, то в таблице сущностей, которых много, указывается ключ той сущности, которая одна.
  К примеру [*Товар*]-<Любит>-E[*Покупатель*], т.е. много *Покупателей* *Любят* один *Товар*. Значит нужно каждому *Покупателю* ключ его любимого *Товара* вписать.

- Если связь N:N, то нужны 2 таблицы для сущностей и 1 для связи.

## create

Можно создать базу данных и сразу дописать в неё всяких настроек

```
 create database Test
	datafile 'test_system' -- где хранить БД
	size 20M -- начальный размер БД
	-- и так далее --


```

Потом, в БД создаётся таблица

```
create table MyTable(
	Id integer primary key, -- это тот самый ключ, о котором шла речь ранее. Он может быть только один.
	StringWithFixedSize char(10) NOT NULL, -- NOT NULL значит, что в столбце не может быть пустых ячеек
	SomeText varchar(250),  -- это то же что и строка выше, но может становиться длиннее 250 символов
	NumWithFloatingPoint NUMERIC(30,2),
	SomeDate Date NOT NULL References AnotherTable(AttribOfAnotherTable) -- можно требовать чтобы данные были взяты из другой таблицы
	Skill char(20) NOT NULL UNIQUE, -- можно потребовать, чтобы данные в столбце не повторялись
	Cost integer CHECK(NumWithFloatingPoint > 0), -- можно проверять данные выражениями
	Unique(Id, NumWithFloatingPoint), -- можно потребовать уникальность комбинации
	-- так же выглядит составной ключ -- primary key(Id, Cost)
)


```

## alter table


```
-- так можно сменить формат столбца таблицы
alter table MyTable modify Cost NUMERIC(42,2) NOT NULL

-- так добавить столбец
alter table MyTable add NewColumn varchar(15) NOT NULL

-- а так удалить
alter table MyTable drop column NewColumn


```

Вся таблица удаляется так же, по аналогии: `drop table MyTable`


</body>
</html>
